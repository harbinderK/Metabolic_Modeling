## Overview
This repository contains three scripts for processing KEGG organism data using TaxIDs, retrieving KO numbers for genes, and updating Krona files with mapped data. The scripts interact with the KEGG database, parse information, and produce tab-separated output files for analyzing nutrient activity based on the taxonomy data from metagenomic samples.

Scripts Included
create_dictionary.py: Download and Parse KEGG Organism Data.
create_KO_matrix.py: Map TaxIDs to Organisms and Create Organism-KO Matrix.
mapping_to_nutrient_cycles.py: Update Krona Files with Mapped Data.

## Prerequisites

- Python 3.x
- Pandas
- Requests
- re

## Installation

Install the required Python packages:

    ```pip install pandas requests   ```
 ## Required Files

- `UDSC_uniquereads_taxidn.txt`: Input file containing unique reads with TaxIDs (Processed output of Centrifuge). Please update the script with the correct path to your input file.

- `krona.proc.gd.tsv`: Original krona file required for mapping 

Make sure all the files and scripts are in the same directory.

## Usage

1. **Download and Parse KEGG Organism Data:**
This script downloads a KEGG text file, extracts the mapping between TaxIDs and organism names, and saves the result as a tab-separated values (TSV) file.

$ python create_dictionary.py
Output
 The script generates a TSV file named taxid_to_org.csv with columns TaxID and Organism_Name.

2. **Generate KO Mapping Matrix:** 

This script reads the organism-to-TaxID mapping from the output file of Script 1, retrieves KO numbers for each gene, and creates an organism-KO matrix, which is saved as a tab-separated values (TSV) file. The input file is the taxonomy file. Please update the script with the correct path to your input file.

$ python create_KO_matrix.py
Output
The script generates a TSV file named matrix_data.tsv with the organism-KO matrix.

3: **Update Krona Files with Mapped Data**
This script reads the organism-KO matrix generated by Script 2 and updates a krona file (krona.proc.gd.tsv) by matching KO IDs and updating the 'Sum' column based on the organism-KO matrix.

$ python mapping_to_nutrient_cycles.py

Output
The script generates a TSV file named mapped_krona.proc.gd.tsv with updated 'Sum' values based on the organism-KO matrix.

## Acknowledgments

- KEGG API
- Pandas Library
- Requests Library

Contact
For any questions or feedback, please contact harbin27_sit@jnu.ac.in.
